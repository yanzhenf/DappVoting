"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("papaparse"),r=require("react");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=o(e),n=o(r),i=function(e,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])},i(e,r)};function l(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}i(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}function a(e,r){for(var o=0,t=r.length,n=e.length;o<t;o++,n++)e[n]=r[o];return e}function s(e){var r=1024,o=1048576,t=1073741824;if(e<o){var n=Number((e/r).toFixed(0));return n<=0?e+" B":n+" KB"}return e<t?(e/o).toFixed(0)+" MB":e<1099511627776?(e/t).toFixed(0)+" GB":""}function d(e,r){var o=!1;"#"==e[0]&&(e=e.slice(1),o=!0);var t=parseInt(e,16),n=(t>>16)+r;n>255?n=255:n<0&&(n=0);var i=(t>>8&255)+r;i>255?i=255:i<0&&(i=0);var l=(255&t)+r;return l>255?l=255:l<0&&(l=0),(o?"#":"")+(l|i<<8|n<<16).toString(16)}function u(e){return n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 512 512"},n.default.createElement("path",{fill:e.color,d:"M504.1 256C504.1 119 393 7.9 256 7.9S7.9 119 7.9 256 119 504.1 256 504.1 504.1 393 504.1 256z"}),n.default.createElement("path",{fill:"#FFF",d:"M285 256l72.5-84.2c7.9-9.2 6.9-23-2.3-31-9.2-7.9-23-6.9-30.9 2.3L256 222.4l-68.2-79.2c-7.9-9.2-21.8-10.2-31-2.3-9.2 7.9-10.2 21.8-2.3 31L227 256l-72.5 84.2c-7.9 9.2-6.9 23 2.3 31 4.1 3.6 9.2 5.3 14.3 5.3 6.2 0 12.3-2.6 16.6-7.6l68.2-79.2 68.2 79.2c4.3 5 10.5 7.6 16.6 7.6 5.1 0 10.2-1.7 14.3-5.3 9.2-7.9 10.2-21.8 2.3-31L285 256z"}))}var p={progressBar:{borderRadius:3,boxShadow:"inset 0 1px 3px rgba(0, 0, 0, .2)",bottom:14,position:"absolute",width:"80%"},buttonProgressBar:{position:"inherit",width:"100%"},progressBarFill:{backgroundColor:"#659cef",borderRadius:3,height:10,transition:"width 500ms ease-in-out"}},c=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return l(r,e),r.prototype.render=function(){var e=this.props,r=e.style,o=e.progressBar,t=e.displayProgressBarStatus,i=e.isButtonProgressBar;return n.default.createElement("div",{style:Object.assign({},p.progressBar,i&&p.buttonProgressBar)},n.default.createElement("span",{style:Object.assign({},p.progressBarFill,r,{width:"".concat(o,"%"),display:t})}))},r}(n.default.Component),f={dropArea:{alignItems:"center",borderStyle:"dashed",borderWidth:2,borderRadius:20,borderColor:"#CCC",display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:20},dropAreaDefaultBorderColor:{borderColor:"#CCC"},inputFile:{display:"none"},highlight:{borderColor:"#686868"},unhighlight:{borderColor:"#CCC"},dropFile:{background:"linear-gradient(to bottom, #EEE, #DDD)",borderRadius:20,display:"block",height:120,width:100,paddingLeft:10,paddingRight:10,position:"relative",zIndex:10},column:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center"},fileSizeInfo:{backgroundColor:"rgba(255, 255, 255, 0.4)",borderRadius:3,lineHeight:1,marginBottom:"0.5em",padding:"0 0.4em"},fileNameInfo:{backgroundColor:"rgba(255, 255, 255, 0.4)",borderRadius:3,fontSize:14,lineHeight:1,padding:"0 0.4em"},defaultCursor:{cursor:"default"},pointerCursor:{cursor:"pointer"},dropFileRemoveButton:{height:23,position:"absolute",right:6,top:6,width:23}},v=function(e){function r(){var r,o,i,l,p,c,v,g,h,m=e.apply(this,arguments)||this;return m.inputFileRef=n.default.createRef(),m.dropAreaRef=n.default.createRef(),m.fileSizeInfoRef=n.default.createRef(),m.fileNameInfoRef=n.default.createRef(),m.REMOVE_ICON_COLOR=m.props.removeButtonColor||(null===(l=null===(i=null===(o=null===(r=m.props.style)||void 0===r?void 0:r.dropArea)||void 0===o?void 0:o.dropFile)||void 0===i?void 0:i.removeButton)||void 0===l?void 0:l.color)||(null===(v=null===(c=null===(p=m.props.style)||void 0===p?void 0:p.dropFile)||void 0===c?void 0:c.removeButton)||void 0===v?void 0:v.color)||(null===(h=null===(g=m.props.style)||void 0===g?void 0:g.removeButton)||void 0===h?void 0:h.color)||"#A01919",m.REMOVE_ICON_COLOR_LIGHT=d(m.REMOVE_ICON_COLOR,40),m.state={dropAreaCustom:{},progressBar:0,displayProgressBarStatus:"none",file:null,timeout:null,files:null,removeIconColor:m.REMOVE_ICON_COLOR,isCanceled:!1},m.componentDidUpdate=function(e){m.props.isReset!==e.isReset&&m.removeFile()},m.componentDidMount=function(){var e=m.dropAreaRef.current;if(e){if(["dragenter","dragover","dragleave","drop"].forEach((function(r){e.addEventListener(r,m.preventDefaults,!1)})),!m.props.noDrag){["dragenter","dragover"].forEach((function(r){e.addEventListener(r,m.highlight,!1)})),e.addEventListener("dragleave",m.unhighlight,!1),e.addEventListener("drop",m.unhighlight,!1),e.addEventListener("drop",m.visibleProgressBar,!1),e.addEventListener("drop",m.handleDrop,!1)}}},m.componentWillUnmount=function(){var e=m.dropAreaRef.current;if(["dragenter","dragover","dragleave","drop"].forEach((function(r){e.removeEventListener(r,m.preventDefaults,!1)})),!m.props.noDrag){["dragenter","dragover"].forEach((function(r){e.removeEventListener(r,m.highlight,!1)})),e.removeEventListener("dragleave",m.unhighlight,!1),e.removeEventListener("drop",m.unhighlight,!1),e.removeEventListener("drop",m.visibleProgressBar,!1),e.removeEventListener("drop",m.handleDrop,!1)}},m.preventDefaults=function(e){e.preventDefault(),e.stopPropagation()},m.highlight=function(){var e,r,o,t,n=m.props.style;m.setState({dropAreaCustom:Object.assign({},(null==n?void 0:n.dropAreaActive)?(null==n?void 0:n.dropAreaActive.borderColor)?null==n?void 0:n.dropAreaActive:Object.assign({},null==n?void 0:n.dropAreaActive,f.highlight):(null===(e=null==n?void 0:n.dropArea)||void 0===e?void 0:e.dropAreaActive)?(null===(r=null==n?void 0:n.dropArea)||void 0===r?void 0:r.dropAreaActive.borderColor)?null===(o=null==n?void 0:n.dropArea)||void 0===o?void 0:o.dropAreaActive:Object.assign({},null===(t=null==n?void 0:n.dropArea)||void 0===t?void 0:t.dropAreaActive,f.highlight):f.highlight)}),m.setState({progressBar:0})},m.unhighlight=function(){var e,r;m.setState({dropAreaCustom:Object.assign({},(null===(r=null===(e=m.props.style)||void 0===e?void 0:e.dropArea)||void 0===r?void 0:r.borderColor)?{}:f.dropAreaDefaultBorderColor)})},m.visibleProgressBar=function(){m.props.noProgressBar||m.setState({displayProgressBarStatus:"block"})},m.handleDrop=function(e){var r=null,o=!1;void 0===e.files?r=e.dataTransfer.files:r=e.files;0===r.length&&(r=m.state.files,o=!0),m.setState({files:r,isCanceled:o},(function(){m.handleFiles()}))},m.handleFiles=function(){m.setState({progressBar:0});a([],m.state.files).forEach(m.uploadFile)},m.uploadFile=function(e){m.displayFileInfo(e),m.setState({file:e});var r=m.props,o=r.onDrop,n=r.onFileLoad,i=r.onError,l=r.config,a=void 0===l?{}:l,s=new window.FileReader,d={},u=e.size,p=[],c=0;if(o||n){var f=m;d=Object.assign({complete:(null==a?void 0:a.complete)||(null==a?void 0:a.step)?a.complete:function(){!o&&n?n(p,e):o&&!n&&o(p,e)},step:(null==a?void 0:a.step)?a.step:function(r){if(p.push(r),a&&a.preview)c=Math.round(p.length/a.preview*100),f.setState({progressBar:c}),p.length===a.preview&&(!o&&n?n(p,e):o&&!n&&o(p,e));else{var t=r.meta.cursor,i=Math.round(t/u*100);if(i===c)return;c=i}f.setState({progressBar:c})}},d)}i&&(d=Object.assign({error:i},d)),a&&(d=Object.assign({},a,d)),s.onload=function(e){t.default.parse(e.target.result,d)},m.props.noProgressBar||(s.onloadend=function(){clearTimeout(m.state.timeout),m.setState({timeout:setTimeout((function(){m.disableProgressBar()}),2e3)})}),s.readAsText(e,a.encoding||"utf-8")},m.displayFileInfo=function(e){m.childrenIsFunction()||(m.fileSizeInfoRef.current.innerHTML=s(e.size),m.fileNameInfoRef.current.innerHTML=e.name)},m.disableProgressBar=function(){m.props.noProgressBar||m.setState({displayProgressBarStatus:"none"})},m.childrenIsFunction=function(){return"function"==typeof m.props.children},m.fileChange=function(e){var r=e.target;m.props.noProgressBar?m.handleDrop(r):m.setState({displayProgressBarStatus:"block"},(function(){m.handleDrop(r)}))},m.open=function(e){var r=m.state.displayProgressBarStatus;e&&"none"===r&&(m.preventDefaults(e),m.inputFileRef.current.value=null,m.inputFileRef.current.click())},m.renderChildren=function(){var e=m.props.children,r=m.state,o=r.file,t=r.progressBar;return m.childrenIsFunction()?e({file:o,progressBar:t}):e},m.handleRemoveFile=function(e){e&&(e.stopPropagation(),m.removeFile())},m.removeFile=function(){m.setState({files:null,file:null});var e=m.props.onRemoveFile;e&&e(null),m.inputFileRef.current.value=null},m.changeRemoveIconColor=function(e){e&&m.setState({removeIconColor:e})},m.renderDropFileRemoveButton=function(){var e=m.props.addRemoveButton,r=m.state,o=r.removeIconColor,t=r.displayProgressBarStatus;return e&&"none"===t?n.default.createElement("div",{style:f.dropFileRemoveButton,onClick:function(e){return m.handleRemoveFile(e)},onMouseOver:function(){return m.changeRemoveIconColor(m.REMOVE_ICON_COLOR_LIGHT)},onMouseOut:function(){return m.changeRemoveIconColor(m.REMOVE_ICON_COLOR)}},n.default.createElement(u,{color:o})):e?n.default.createElement("div",{style:f.dropFileRemoveButton},n.default.createElement(u,{color:m.REMOVE_ICON_COLOR})):null},m}return l(r,e),r.prototype.render=function(){var e,r,o,t,i,l,a,s,d,u,p,v,g,h=this,m=this.props,C=m.style,E=m.noClick,R=m.children,B=m.noProgressBar,b=m.progressBarColor,y=m.accept,O=this.state,S=O.dropAreaCustom,F=O.files,A=O.isCanceled,I=O.progressBar,P=O.displayProgressBarStatus;return n.default.createElement(n.default.Fragment,null,n.default.createElement("input",{type:"file",accept:y||"text/csv, .csv, application/vnd.ms-excel",ref:this.inputFileRef,style:f.inputFile,onChange:function(e){return h.fileChange(e)}}),this.childrenIsFunction()?n.default.createElement("div",{ref:this.dropAreaRef},this.renderChildren(),F&&F.length>0&&!A&&!B&&n.default.createElement(c,{style:Object.assign({},b?{backgroundColor:b}:{},(null===(v=null===(p=null==C?void 0:C.dropArea)||void 0===p?void 0:p.dropFile)||void 0===v?void 0:v.progressBar)||(null===(g=null==C?void 0:C.dropFile)||void 0===g?void 0:g.progressBar)||(null==C?void 0:C.progressBar)),progressBar:I,displayProgressBarStatus:P,isButtonProgressBar:!0})):n.default.createElement("div",{ref:this.dropAreaRef,style:Object.assign({},f.dropArea,null==C?void 0:C.dropArea,S,void 0!==E||"block"===P?f.defaultCursor:f.pointerCursor),onClick:function(e){E||h.open(e)}},F&&F.length>0?n.default.createElement("div",{style:Object.assign({},f.dropFile,f.column,(null===(e=null==C?void 0:C.dropArea)||void 0===e?void 0:e.dropFile)||(null==C?void 0:C.dropFile))},this.renderDropFileRemoveButton(),n.default.createElement("div",{style:f.column},n.default.createElement("span",{style:Object.assign({},f.fileSizeInfo,(null===(o=null===(r=null==C?void 0:C.dropArea)||void 0===r?void 0:r.dropFile)||void 0===o?void 0:o.fileSizeInfo)||(null===(t=null==C?void 0:C.dropArea)||void 0===t?void 0:t.fileSizeInfo)||(null==C?void 0:C.fileSizeInfo)),ref:this.fileSizeInfoRef}),n.default.createElement("span",{style:Object.assign({},f.fileNameInfo,(null===(l=null===(i=null==C?void 0:C.dropArea)||void 0===i?void 0:i.dropFile)||void 0===l?void 0:l.fileNameInfo)||(null===(a=null==C?void 0:C.dropFile)||void 0===a?void 0:a.fileNameInfo)||(null==C?void 0:C.fileNameInfo)),ref:this.fileNameInfoRef})),F&&F.length>0&&!A&&!B&&n.default.createElement(c,{style:Object.assign({},b?{backgroundColor:b}:{},(null===(d=null===(s=null==C?void 0:C.dropArea)||void 0===s?void 0:s.dropFile)||void 0===d?void 0:d.progressBar)||(null===(u=null==C?void 0:C.dropFile)||void 0===u?void 0:u.progressBar)||(null==C?void 0:C.progressBar)),progressBar:I,displayProgressBarStatus:P})):R))},r.defaultProps={isReset:!1},r}(n.default.Component),g=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.download=function(e,r,o,n){var i=o?"\ufeff":"",l=null,a=null;"function"==typeof e&&(e=e()),l="object"==typeof e?t.default.unparse(e,n):e;var s=new Blob(["".concat(i).concat(l)],{type:"text/csv;charset=utf-8;"}),d=window.navigator;a=d.msSaveBlob?d.msSaveBlob(s,"".concat(r,".csv")):window.URL.createObjectURL(s);var u=document.createElement("a");u.href=a,u.setAttribute("download","".concat(r,".csv")),u.click(),u.remove()},r}return l(r,e),r.prototype.render=function(){var e=this,r=this.props,o=r.children,t=r.data,i=r.filename,l=r.type,a=r.className,s=r.style,d=r.bom,u=void 0!==d&&d,p=r.config,c=void 0===p?{}:p;return"link"===l?n.default.createElement("a",{onClick:function(){return e.download(t,i,u,c)},className:a,style:s},o):n.default.createElement("button",{onClick:function(){return e.download(t,i,u,c)},className:a,style:s},o)},r.defaultProps={type:"link"},r}(n.default.Component);var h=t.default.BAD_DELIMITERS,m=t.default.RECORD_SEP,C=t.default.UNIT_SEP,E=t.default.WORKERS_SUPPORTED,R=t.default.LocalChunkSize,B=t.default.DefaultDelimiter;exports.BAD_DELIMITERS=h,exports.BUTTON_TYPE="button",exports.CSVDownloader=g,exports.CSVReader=v,exports.DefaultDelimiter=B,exports.LINK_TYPE="link",exports.LocalChunkSize=R,exports.RECORD_SEP=m,exports.UNIT_SEP=C,exports.WORKERS_SUPPORTED=E,exports.jsonToCSV=function(e,r){return void 0===r&&(r={}),t.default.unparse(e,r)},exports.readRemoteFile=function(e,r){t.default.parse(e,Object.assign({},{download:!0},r))},exports.readString=function(e,r){return t.default.parse(e,r)};
